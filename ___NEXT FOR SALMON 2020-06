Long list of things to be added to the Salmon Model

Update circa 04-19-2022
Fix chinook recovery database. (done)
Query spring Chinook recoveries, make basic plots of where and when each is recovered.
Incorporate Alex's edits to fix the spawning calendar.
Add to recovery database.


4-19-2022 Notes
working out of spring-chinook-distribution GitRepo.
Adjusted all_chinook.RData to avoid leading zeros problem.
adjusted releases from 2020_07 to avoid read-in error
Made CWT control files folder.

05/02/2022 Notes
Looked through spr-sum releases. Fixed "01" script so all releases and recoveries were properly dealt with. Added dplyr summary scripts to marine recoveries and debugged some release duplications.  Moved on to mapping recovery locations.  Looked through rec.area.codes
COPPER - only gillnet fisheries (16 fish total).  Will be excluded later.
CISS - more than COPPER but all net fisheries (fishery 20, 28) months - May-Aug. Will be excluded later.
PWS - 49 fish total. all summertime gillnet fisheries. Almost entirely in the Wally Norenberg terminal area...
YAK - lots more recoveries (2448). fisheries = troll (2328 (10) + 45(11)), net(12), rec (60), a handful of test fishery fish (3)
EAPEN - 38 recoveries all from gillnet
NWGOA - 268 recoveries.  All from gillnet

5/3/2022
Looked over the recovery area mapping process.  I kept CISS, PWS, COPPER areas separate for now.  They are all net fisheries and will likely get dropped later. I double checked the mapping to the YAK area for troll fisheries. It looks correct.
I modified some more aggregate functions and moved them to dplyr.
THen I rediscovered Genoa's "Process ALASKA pollock effort.R" file (in the spring-chinook-distribution repo)

5/4-5/5/2022.
Did a deep dive on the CWT and recoveries in the pollock fishery.  Decided to use the CWT files from the observer program in AK because they provide lat-long recoveries and provide a way to isolate which recoveries are from the pollock fleet. There is some complicated matching that occurs between the recovered CWT, observer coverage, and other processes. There are a lot of fish that are included in the pollock fleet because they were collected during a time when the pollock fleet was open and fishing. There remains some questions about whether we should allow recoveries associated with times adjacent to

NEXT. Alaska rockfish fleet. Should be pretty easy.

5/23/2022
Completed all alaskan fisheries, wrote all to file, moved on to the "02_.." file.
Updated beginning of 02 file.
Moved on to recreational fishery data. Updated effort for Puget Sound from pamphlets.
Examined emergency rules for changes to the opening / closing / chinook retention.  Updated WA PUSO Chinook Retention thru 2020. This includes all changes made by emergency rule between 2003 and 2020.
Also updated Chinook size limits on rec fisheries (vuln.rec files).
Updated files are in the Orca_salmon_data folders

5/24/2022-6/17/2022
Ran into some trouble with the Alaska Troll effort files.  Switched from a poor proxy for effort (approximate boat days) to landings.  Double checked the hand troll to power troll conversion (into power-troll equivalents)  using:
[CPUE(Hand) / CPUE(Power)] * Hand_Landings.
Modified the fraction of effort in each month and found some problems in the post 2015 data that was causing negative proportions. Fixed that.  Wrote alaska troll effort to file "effort.data.ak.2022-06.csv" is the file to use in all future analyses.

7/28/22
Finally back to the spring model after getting the OCNMS surveys up and running.
Updated CA, OR, WA troll effort through 2018 (CA) or through 2019 (WA, OR).
Updated and checked code for Treaty Troll fleets
Updated and checked ASHOP and Shoreside fleets. (only data through 2017...)
Began new scripts to read in data from the AK Rockfish and Pollock Shoreside.

8/1/2022-8/10/2022
Worked on many things... Fixed and finished AK effort files (shoreside pollock and rockfish (both CP and shoreside)). Improved and debugged extraction of CWT files for all gear groups.  Fixed recovery area assignments.

8/24/2022
Did a bunch of work for Sean Matson helping out with hake bycatch.  From him I got updated data for CWT recoveries from ASHOP and Shoreside.  I still only have effort data for ASHOP through 2017 and for Shoreside through 2016 (I think).  But now I have the CWT recoveries at least.

9/21/2022
Spent the last few days slogging through the 02... code.  Specifically, I made a number of changes to the processing code (e.g. removed / changed references to reshape2 package).
Requested new, updated data from ASHOP.  Will submit new request to PSMFC soon for shoreside data.
Found problems with the Puget Sound rec data.  Rechecked all of the data I have in hand (1978-80 and 1995-present).  Need to poke at the 1981-1994 data in the UW library.


9/30/2022
Spent the week finding and fixing errors and conflicts in "02_..."
Found Alaska fish ticket data on my computer, used it to derive effort (landings) estimates for 1979-84 troll data.  This data differs slightly from the data provided by J. Carlile.  Not really sure why... But it is strongly correlated. I'm going to use it.  This pushes the years of recovery back to 1979.
Receive the complete dataset from the CTC.  Will look at it next week to determine how best to use it.
Requested additional data from the shoreside hake fleets. Hope to get ASHOP and shoreside data updates back soon.
Started to work on the heatmap scripts and am planning make additional updates to them soon.

10/7/2022
Spent much of the week on other things but did create a progress report for the regional office.  It forced me to look carefully at a lot of the plots of ocean recoveries for different runs.  They are very illuminating. They emphasize the importance of being able to deal with the different catchability for different runs and for being able to look at spawn timing and accessibility to fisheries for different runs.
Will work on the AWG stocks next (and the in-river data in particular) and think about size-at-age.


10/25-31/2022
Received AWG from the CTC.  Have been extensively processing the data.
Parsed the various net recoveries to try and come up with a defensible set of choices about who qualifies as in-river.
In script 01...
Move fishery code 20 to freshwater (they are all terminal gillnets in AK or CAN)

I compiled all of the FW recoveries, merged in the AWG data and made a bunch of plots of the recoveries by region and

CA - Chat with Will Sat...
no run reconstructions for spring run in CV (SFB_butte_spr, SFB_feather_spr)
Winter run work for management is not strictly from RMIS... but actually getting this raw data seems unlikely.
We know that the Trinity spring has missing data.
There is good information suggesting these stocks don't go on walk about offshore.  So assuming they all stay in-bounds is ok/
Conclusion: Scale the river recoveries by their proportional abundance, but do not include their raw FW recoveries in the estimation model.

OR Coast-
SOR, COR both have not- great patterns on FW recoveries but I do not have any direct information about the quality of FW information. Hope to get some info from the OR folk for the listing criteria later this week.

COL basin.
This is the first place that auxiliary AWG data comes into play.  It is important for WILL_spr but not for upriver stock.  This includes stocks which are in the CTC model like UCOL_sum as well as others that are not.  There were virtually no auxiliary recoveries from the URB stock as well.

11/30/22.
Talked to Alan Byrne this week about Idaho data and figured out where to get teh PIT data from Columbia river dam tagging.  I think they will flesh out the needed survival information for

Here are the years of PIT survival data.

Up Col PIT data.  outmigrant years: 2000-19: Release to Bonneville
Combined Hatch_Wild Spring Chinook tagged at Rock Island Dam
Combined Hatch_Wild Summer Chinook tagged at Rock Island Dam
Entiat and Methow River Wild Spring Chinook
Entiat Hatchery Summer Chinook
Leavenworth Hatchery Spring Chinook
Upper Columbia River (above Wells Dam) Wild Summer Chinook
Wenatchee River Wild Spring Chinook
Winthrop Hatchery Spring Chinook

Mid Col PIT data.  outmigrant years: 2000-19 Release to Bonneville
Carson Hatchery Spring Chinook
Cle Elum Hatchery Spring Chinook
Deschutes River Wild Fall Chinook
Hanford Reach Wild Fall Chinook
John Day River Wild Spring Chinook
Little White Salmon Hatchery Fall Chinook
Spring Creek Hatchery Fall Chinook (April Release)
Spring Creek Hatchery Fall Chinook (March Release)
Spring Creek Hatchery Fall Chinook (May Release)
Warm Springs Hatchery Spring Chinook
Yakima River Wild Spring Chinook

Snake River PIT DATA:2000-19.  Lower Granite to Bonneville
Catherine Creek Hatchery Spring Chinook
Clearwater Hatchery Spring Chinook
Clearwater Hatchery Summer Chinook
Dworshak Hatchery Fall Chinook at Snake River (Surrogates)
Dworshak Hatchery Spring Chinook
Grande Ronde River Hatchery Fall Chinook
Imnaha Hatchery Summer Chinook
Kooskia Hatchery Spring Chinook
Lyons Ferry Hatchery Fall Chinook at Big Canyon Creek AP
Lyons Ferry Hatchery Fall Chinook at Captain John Rapids AP
Lyons Ferry Hatchery Fall Chinook at Pittsburg Landing AP
Lyons Ferry Hatchery Fall Chinook at Snake River
McCall Hatchery Summer Chinook
Nez Perce Hatchery Fall Chinook at Cedar Flats AP
Nez Perce Hatchery Fall Chinook at Lukes Gulch AP
Oxbow Hatchery Fall Chinook below Hells Canyon Dam
Pahsimeroi Hatchery Summer Chinook
Rapid River Hatchery Spring Chinook
Sawtooth Hatchery Spring Chinook
Umatilla_Irrigon Hatchery Fall Chinook below Hells Canyon Dam




########################################

Fisheries and Effort:
New AK troll effot data
BC hake data
Alaska Pollock
Alaska Rockfish
AK troll- separate inside vs. outside troll
What to do about net fisheries.

Recoveries:
Split out Alaska areas
APEN
KODIAK
CISS
PWS
PWS - inside
YAK

Catchability:
Allow for distinct, run-type Catchability

Spatial boxes:
Add Yakutat and GOA areas.

Vulnerability
Splines and/or Quadratic for rec and troll.

Genetic information
GSI sources
Defining discrete origins in the Model

Maturity
Force all remaining fish to enter the river at age 6 (would likely get rid of need for old age penalty.)---- DONE.
Let Maturity vary from year to year.
Add spring life-history option for spawn timing

Environment
PDO & NPGO as covariates.

OTHER:
TRY OUT ESTIMATING ADULT M with the different mortality schedule.





SHORT TERM TO DO FOR PAPER
DIC
UPDATE ALL PLOTS IN MAIN TEXT, S5
ABSTRACT
RE-READ S1, S3.

S5:
WIDE FORM DISTRIBUTION USING ALL OF REGIONS
INCLUDE DISTRIBUTION ESTIMATES FOR PUSO AND SUCH?
DIFFERENT HARVEST FRACTIONS FOR SUPPLEMENTAL FIGURES FIG.5
